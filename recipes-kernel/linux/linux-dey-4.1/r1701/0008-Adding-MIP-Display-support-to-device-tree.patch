From d2ef0195995963bda03dfd551e1ad19d770d71c1 Mon Sep 17 00:00:00 2001
From: Devang Patel <dpatel@hach.com>
Date: Thu, 30 Nov 2017 08:32:58 -0700
Subject: [PATCH 8/8] Adding MIP Display support to device tree

---
 arch/arm/boot/dts/imx6ul-r1701-wb.dts | 52 +++++++++++++++++++++++++++++++++++
 arch/arm/boot/dts/imx6ul-r1701.dts    | 52 +++++++++++++++++++++++++++++++++++
 2 files changed, 104 insertions(+)

diff --git a/arch/arm/boot/dts/imx6ul-r1701-wb.dts b/arch/arm/boot/dts/imx6ul-r1701-wb.dts
index dfdb1f4..052f10b 100644
--- a/arch/arm/boot/dts/imx6ul-r1701-wb.dts
+++ b/arch/arm/boot/dts/imx6ul-r1701-wb.dts
@@ -144,4 +144,56 @@
 &uart5 {
 	status = "okay";
 };
+
+&ecspi3 {
+
+    cs-gpios    = <&gpio1 20 GPIO_ACTIVE_HIGH>;
+    pinctrl-0   = <&pinctrl_ecspi3_master>;
+    status      = "okay";
+
+    /* 2.7" Landscape MIP Display */
+    mipDisplay: ecspi@0{
+        compatible          = "sharp,ls027b7dh01";
+        reg                 = <0>;
+        spi-max-frequency   = <2000000>;
+        spi-cs-high;
+        gpios               = <&gpio3 4  GPIO_ACTIVE_HIGH>,  /* DISP PIN     */
+                              <&gpio3 10 GPIO_ACTIVE_HIGH>;  /* EXTCOMIN PIN */
+        status = "okay";
+    };
+
+    /* 3.2" Portrait MIP Display */
+    /*
+    mipDisplay: ecspi@0{
+        compatible 		= "sharp,ls032b7dd02";
+        reg                 = <0>;
+        spi-max-frequency   = <2000000>;
+        spi-cs-high;
+        gpios               = <&gpio3 4  GPIO_ACTIVE_HIGH>,  // DISP PIN
+                              <&gpio3 10 GPIO_ACTIVE_HIGH>;  // EXTCOMIN PIN
+        status = "okay";
+    };
+    */
+};
+
+/* Pin mux configuration */
+&iomuxc {
+    imx6ul-ccimx6ul {
+        pinctrl_ecspi3_master: ecspi3grp1 {
+            fsl,pins = <
+                MX6UL_PAD_UART2_RX_DATA__ECSPI3_SCLK    0x10b0
+                MX6UL_PAD_UART2_CTS_B__ECSPI3_MOSI      0x10b0
+                MX6UL_PAD_UART2_RTS_B__ECSPI3_MISO      0x10b0
+                MX6UL_PAD_UART2_TX_DATA__GPIO1_IO20     0x30b0 /* Chip Select */
+            >;
+        };
+
+        pinctrl_additionalgpio: additionalgpios {
+            fsl,pins = <
+                MX6UL_PAD_LCD_RESET__GPIO3_IO04         0x3031
+                MX6UL_PAD_LCD_DATA05__GPIO3_IO10        0x3031
+            >;
+        };
+    };
+};
 #endif
diff --git a/arch/arm/boot/dts/imx6ul-r1701.dts b/arch/arm/boot/dts/imx6ul-r1701.dts
index 7652eec..e038838 100644
--- a/arch/arm/boot/dts/imx6ul-r1701.dts
+++ b/arch/arm/boot/dts/imx6ul-r1701.dts
@@ -144,4 +144,56 @@
 &uart5 {
 	status = "okay";
 };
+
+&ecspi3 {
+
+    cs-gpios    = <&gpio1 20 GPIO_ACTIVE_HIGH>;
+    pinctrl-0   = <&pinctrl_ecspi3_master>;
+    status      = "okay";
+
+    /* 2.7" Landscape MIP Display */
+    mipDisplay: ecspi@0{
+        compatible          = "sharp,ls027b7dh01";
+        reg                 = <0>;
+        spi-max-frequency   = <2000000>;
+        spi-cs-high;
+        gpios               = <&gpio3 4  GPIO_ACTIVE_HIGH>,  /* DISP PIN     */
+                              <&gpio3 10 GPIO_ACTIVE_HIGH>;  /* EXTCOMIN PIN */
+        status = "okay";
+    };
+
+    /* 3.2" Portrait MIP Display */
+    /*
+    mipDisplay: ecspi@0{
+        compatible 		= "sharp,ls032b7dd02";
+        reg                 = <0>;
+        spi-max-frequency   = <2000000>;
+        spi-cs-high;
+        gpios               = <&gpio3 4  GPIO_ACTIVE_HIGH>,  // DISP PIN
+                              <&gpio3 10 GPIO_ACTIVE_HIGH>;  // EXTCOMIN PIN
+        status = "okay";
+    };
+    */
+};
+
+/* Pin mux configuration */
+&iomuxc {
+    imx6ul-ccimx6ul {
+        pinctrl_ecspi3_master: ecspi3grp1 {
+            fsl,pins = <
+                MX6UL_PAD_UART2_RX_DATA__ECSPI3_SCLK    0x10b0
+                MX6UL_PAD_UART2_CTS_B__ECSPI3_MOSI      0x10b0
+                MX6UL_PAD_UART2_RTS_B__ECSPI3_MISO      0x10b0
+                MX6UL_PAD_UART2_TX_DATA__GPIO1_IO20     0x30b0 /* Chip Select */
+            >;
+        };
+
+        pinctrl_additionalgpio: additionalgpios {
+            fsl,pins = <
+                MX6UL_PAD_LCD_RESET__GPIO3_IO04         0x3031
+                MX6UL_PAD_LCD_DATA05__GPIO3_IO10        0x3031
+            >;
+        };
+    };
+};
 #endif
-- 
2.7.4

